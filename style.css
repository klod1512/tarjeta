/* ======================================= */
/* 0. Centrado del Contenedor Principal */
/* ======================================= */
.cake-container {
    position: relative;
    display: block;
    margin: 0 auto;
    width: 800px; /* Tamaño grande, ajustaremos los elementos dentro */
    height: 800px;
}

/* ======================================= */
/* 0.5. ESTILOS DEL PASTEL (#cake) - ¡AÑADIDO! */
/* ======================================= */
#cake {
    position: absolute;
    /* Posición centrada en la parte inferior del contenedor */
    bottom: 200px; 
    left: 50%;
    transform: translateX(-50%);

    /* Dimensiones para que sea visible (AJUSTA ESTOS VALORES si tu pastel es más complejo) */
    width: 300px;
    height: 150px;
    background-color: #f7a0b5; /* Color base de ejemplo */
    border-radius: 10px 10px 0 0;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    z-index: 5; /* Asegura que esté por debajo de la vela */
}

/* ======================================= */
/* 1. Estilos de la Vela Completa (Cera) */
/* ======================================= */
.vela-cera {
    position: absolute;
    top: -50%; /* Posición inicial fuera de la vista */
    left: 50%; /* Centrado sobre el pastel */
    transform: translateX(-50%);
    opacity: 0;
    transition: top 0.25s ease-out, opacity 0.25s ease-out;

    width: 10px;
    height: 60px;
    background-color: #d23763; /* Color de cera */
    z-index: 10;
}

.vela-cera.swaying {
    animation: candle-sway 3s infinite alternate ease-in-out;
}

/* ======================================= */
/* 2. Estilos de la Flama y el Fuego */
/* ======================================= */
.fuego-llama-onda {
    position: absolute;
    top: -22px;
    left: 50%; /* Centra la flama */
    transform: translateX(-50%);
    width: 10px;
    height: 25px;
    transform-origin: bottom center;
}

.llama-onda {
    position: absolute;
    width: 100%;
    height: 100%;
    background-color: #e1e0de;
    border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
    box-shadow:
        0 0 10px 3px #fac104,
        0 0 20px 5px #f67a28;
    z-index: 2;
    animation: flame-movement 1.5s infinite alternate ease-in-out; /* Aplica la animación aquí */
}

.fuego-onda {
    position: absolute;
    width: 150%;
    height: 150%;
    top: -25%;
    left: -25%;
    background-color: #ecd90b;
    border-radius: 50%;
    filter: blur(2px);
    opacity: 0.7;
    z-index: 0;
}

/* Ajuste de keyframes para la llama */
@keyframes flame-movement {
    0% { transform: translateX(0%) rotate(2deg); }
    33% { transform: translateX(-10%) rotate(3deg); }
    66% { transform: translateX(10%) rotate(-3deg); }
    100% { transform: translateX(0%) rotate(0deg); }
}

/* Keyframes para el balanceo de la cera */
@keyframes candle-sway {
    0% { transform: translateX(-50%) rotate(1deg); }
    50% { transform: translateX(-50%) rotate(-1deg); }
    100% { transform: translateX(-50%) rotate(1deg); }
}

/* ======================================= */
/* 5. Estilos de Visibilidad/Caída de la Vela */
/* ======================================= */
.cake-container.mostrar-vela .vela-cera {
    /* Nueva Posición Final: AJUSTA este valor (en px o %) para que quede sobre tu pastel */
    top: 52%; 
    opacity: 1;
    visibility: visible;
}

/* ======================================= */
/* 6. Estilos del Confeti y Humo */
/* ======================================= */
.confetti-container {
    position: fixed;
    top: 0; /* Cambio a 0 para cubrir toda la pantalla */
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    overflow: hidden;
    z-index: 500;
    opacity: 0;
    transition: opacity 0.5s;
}

.confetti-container.explode {
    opacity: 1;
    animation: explode-fade-out 0.10s forwards;
}

.confetti-container.explode:before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    height: 100%;
    box-shadow:
        /* Añade muchos puntos de color para simular la explosión */
        15px -15px 0 1px #ff00ff, 30px 25px 0 1px #ffc0cb,
        /* ... el resto de tu box-shadow ... */
        25px 0px 0 1px #780762, -25px 0px 0 1px #f8a604,
        0px 20px 0 1px #ff00ff, 0px -25px 0 1px #780762,
        30px 10px 0 1px #ffc0cb, -30px 10px 0 1px #f8a604,
        10px -30px 0 1px #ff00ff, -10px -30px 0 1px #780762;
    
    animation: confetti-scatter 0.10s forwards;
}

/* No hay keyframes para confetti-scatter o explode-fade-out, asumo que existen o son opcionales */

.smoke-puff {
    position: fixed;
    width: 20px;
    height: 20px;
    background-color: #2a2929;
    border-radius: 50%;
    filter: blur(5px);
    opacity: 0;
    transform: scale(0);
    z-index: 9;
    pointer-events: none;
    transition: opacity 1.5s ease-out, transform 1.5s ease-out, top 6s ease-out;
}

.smoke-puff.active {
    opacity: 0.8;
    transform: scale(2.5);
}

.hint-glow {
    position: fixed;
    width: 30px;
    height: 20px;
    background: radial-gradient(circle, rgba(255, 255, 100, 0.8) 0%, rgba(137, 121, 66, 0) 70%);
    border-radius: 50%;
    z-index: 15;
    pointer-events: none;
    opacity: 0;
    transition: opacity 2s;
    animation: glow-pulse 1s infinite alternate;
}

/* ======================================= */
/* 7. Estilos de Botones y Tarjetas */
/* ======================================= */

.action-button {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    bottom: 120px; /* Posición visible BAJO el pastel */
    
    padding: 10px 20px;
    background-color: #ff00a2; 
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s;
    z-index: 20;
}

.action-button.visible {
    opacity: 1;
    visibility: visible;
}

.mini-card {
    position: fixed;
    /* Centrado visual para un tamaño pequeño */
    bottom: 300px;
    left: 50%;
    transform: translateX(-50%); 

    width: 92px;
    height: 30px;
    background-color: #ff00a2;
    border-radius: 8px;
    text-align: center;
    line-height: 30px;
    font-family: 'Gloria Hallelujah', sans-serif;
    color: white;
    font-size: 0.8em;
    
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.5s, transform 0.5s;
    z-index: 1000;
    cursor: pointer;
}

.mini-card.visible {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) scale(1.1); /* Llama la atención */
}

/* ======================================= */
/* 8. Tarjeta Expandida (Mensaje Largo) */
/* ======================================= */
.expanded-card {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.8);
    
    /* Dimensiones responsivas */
    width: 90%;
    max-width: 450px;
    max-height: 90vh; /* CRÍTICO: Altura máxima para permitir scroll */
    
    /* Estilos visuales basados en tu código */
    background-color: #fefae0;
    color: #000000;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
    z-index: 2000; /* Alto z-index para estar sobre todo */
    
    /* Espaciado del contenido (ajustado de tu padding excesivo) */
    padding: 30px; 
    line-height: 1.6;

    /* Oculto por defecto */
    opacity: 0;
    visibility: hidden;
    overflow-y: hidden;
    transition: opacity 0.4s, transform 0.4s, visibility 0.4s;
}

.expanded-card.visible {
    opacity: 1; 
    visibility: visible;
    transform: translate(-50%, -50%) scale
